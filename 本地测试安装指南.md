# 🖥️ 本地测试安装指南

## 📋 需要安装的软件

为了完整测试所有功能，本地需要安装：

1. **Node.js** - 运行服务器（必需）
2. **yt-dlp** - 高质量视频下载（可选，但推荐）
3. **ffmpeg** - 合并视频和音频（可选，但推荐）

## ✅ 快速安装步骤

### 1. 安装 Node.js（如果还没有）

访问：https://nodejs.org/zh-cn/
- 下载 LTS 版本
- 安装时勾选"添加到 PATH"
- 验证：打开命令提示符，输入 `node --version`

### 2. 安装 yt-dlp

#### Windows（推荐方法）

**方法一：使用 pip（需要先安装 Python）**
```powershell
# 1. 安装 Python（如果还没有）
# 访问 https://www.python.org/downloads/
# 下载并安装，记得勾选"Add Python to PATH"

# 2. 安装 yt-dlp
pip install yt-dlp

# 3. 验证
yt-dlp --version
```

**方法二：直接下载可执行文件（最简单）**
```powershell
# 1. 访问 https://github.com/yt-dlp/yt-dlp/releases
# 2. 下载 yt-dlp.exe（Windows版本）
# 3. 放到任意文件夹（如 C:\tools\）
# 4. 将该文件夹添加到系统 PATH
#    或直接放在项目文件夹中
```

**方法三：使用包管理器**
```powershell
# 使用 Chocolatey
choco install yt-dlp

# 或使用 winget
winget install yt-dlp
```

### 3. 安装 ffmpeg（重要！解决有视频无声音问题）

#### Windows

**方法一：使用 Chocolatey（推荐）**
```powershell
choco install ffmpeg
```

**方法二：使用 winget**
```powershell
winget install ffmpeg
```

**方法三：手动安装**
1. 访问 https://ffmpeg.org/download.html
2. 下载 Windows 版本
3. 解压到 `C:\ffmpeg`
4. 添加到系统 PATH：
   - 右键"此电脑" → 属性 → 高级系统设置 → 环境变量
   - 系统变量 → Path → 编辑 → 新建 → 添加 `C:\ffmpeg\bin`
   - 确定保存

**方法四：使用 scoop**
```powershell
scoop install ffmpeg
```

## 🔍 验证安装

打开命令提示符（**新开一个窗口**，因为环境变量需要重新加载），输入：

```powershell
# 检查 Node.js
node --version

# 检查 yt-dlp
yt-dlp --version

# 检查 ffmpeg
ffmpeg -version
```

如果都显示版本号，说明安装成功！

## 🚀 启动测试

1. **安装项目依赖**：
   ```powershell
   npm install
   ```

2. **启动服务器**：
   ```powershell
   npm start
   ```

3. **访问应用**：
   打开浏览器访问 `http://localhost:3000`

4. **测试下载**：
   - 解析一个视频
   - 点击"高质量下载"按钮
   - 检查下载的视频是否有声音和画面

## ⚠️ 常见问题

### Q: 安装后还是提示未找到？

**解决方法**：
1. **关闭所有命令提示符窗口**
2. **重新打开新的命令提示符**
3. **重新验证**（环境变量需要重新加载）

### Q: pip 命令不可用？

**解决方法**：
1. 确保 Python 已安装
2. 安装时勾选了"Add Python to PATH"
3. 或使用 `python -m pip install yt-dlp`

### Q: 下载的视频有画面没声音？

**解决方法**：
- 确保安装了 **ffmpeg**
- 重启服务器
- 重新测试

### Q: 不想安装这么多东西？

**可以只安装 Node.js**，其他功能会降级使用：
- 没有 yt-dlp：使用普通下载方式
- 没有 ffmpeg：选择已合并的格式（可能画质较低）

## 📝 最小安装（仅测试基本功能）

如果只想测试基本功能，**只需安装 Node.js**：

```powershell
# 1. 安装 Node.js
# 2. npm install
# 3. npm start
```

其他功能会优雅降级，不影响基本使用。

## 🎯 完整安装（推荐）

为了获得最佳体验，建议安装所有组件：

```powershell
# 1. Node.js（必需）
# 2. yt-dlp（推荐）
# 3. ffmpeg（推荐，解决音视频问题）
```

---

**提示**：安装完成后记得**重启命令提示符**或**重启电脑**，让环境变量生效！

